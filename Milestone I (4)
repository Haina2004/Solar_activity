class TimeSeries:
    def __init__(self, start_date, end_date, cadence=2):
        self.start_date = start_date
        self.end_date = end_date
        self.cadence = cadence
   
    def process_images(self):
        #用AIA Synoptic data base
        pass

    def analyze_images(self):
        #用AImage
        pass
----------------------------------
import numpy as np
from astropy.io import fits

#这里需要现在他给的notebook里run一下 def read_aia_synptic_image 和def set_sun_aperture的code

class AImage:
    def __init__(self, url, rsun_factor=1, minval=0.01):
        self.image, self.img_header = self.read_aia_synoptic_image(url)
        self.image = self.set_sun_aperture(self.image, self.img_header, rsun_factor, minval)

    def read_aia_synoptic_image(self, url): 

        with fits.open(url) as fimg:
            image = fimg[1].data
            img_header = fimg[1].header
        return image, img_header

    def set_sun_aperture(self, img, img_header, rsun_factor, minval):

      r_sun = img_header["IMSCL_MP"] * img_header['R_SUN']
      dx_pix2sec, dy_pix2sec = img_header['CDELT1'], img_header['CDELT2']
    
      _img = np.copy(img)
      imin = _img.min()
      nrow, ncol = np.shape(_img)
      isum, nsum = 0, 0  
      nrh = nrow // 2
      nch = ncol // 2
      Y, X = np.ogrid[:nrow, :ncol]
      rcenter = np.sqrt(((X - nch)*dx_pix2sec)**2 + ((Y - nrh)*dy_pix2sec)**2)
      rcut = rsun_factor * r_sun
      _img[rcenter > rcut] = minval        
      return _img

    def compute_median(self):
        return np.median(self.image)

    def compute_percentile(self, percentile):
        return np.percentile(self.image, percentile)
    def compute_mean(self)
        return np.mean(self.image)
# Example Usage
url = 'http://jsoc.stanford.edu/data/aia/synoptic/2012/07/01/H0000/AIA20120701_0000_4500.fits'
aimage = AImage(url, rsun_factor=1.5)
print(f"Mean: {aimage.compute_mean()}")
print(f"Median: {aimage.compute_median()}")
print(f"90th Percentile: {aimage.compute_percentile(90)}")
——————————————————————————————
class AIATimeSeries:
    def __init__(self, start_date, end_date, time_cadence, wavelength, rsun_factor=1, minval=0.01):
        '''
        Initialize the AIATimeSeriesAnalyzer object.

        Parameters:
            start_date: str, starting date for the analysis in YYYY-MM-DD format.
            end_date: str, ending date for the analysis in YYYY-MM-DD format.
            time_cadence: int, number of days between each image.
            wavelength: str, wavelength filter for the images.
            rsun_factor: float, factor to multiply with Sun's radius for image cropping.
            minval: float, value to set for pixels outside the cropped area.
        '''
        self.start_date = start_date
        self.end_date = end_date
        self.time_cadence = time_cadence
        self.wavelength = wavelength
        self.rsun_factor = rsun_factor
        self.minval = minval
        self.images = []


    def process_images(self, year=2023, filt='0335', day_cadence=2):
        base_url = f'http://jsoc.stanford.edu/data/aia/synoptic/{year}/'
        day_cadence = max(day_cadence, 2)

        for month in range(1, 13): 
            for day in range(1, 32, day_cadence):
                formatted_month = str(month).zfill(2)
                formatted_day = str(day).zfill(2)
                url = f"{base_url}{formatted_month}/{formatted_day}/H0000/AIA{year}{formatted_month}{formatted_day}_0000_{filt}.fits"
                yield url

    def analyze_images(self):
        median_value = self.AImage_instance.compute_median()
        percentile_value = self.AImage_instance.compute_percentile()
        pass

    def generate_statistics(self):
        '''
        Generate and return basic statistics for the analyzed images.
        '''
        pass

    def visualize_data(self):
        '''
        Visualize the time series data.
        '''
        pass

    # Additional methods can be added here for more specific analysis or data handling.
